
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>The Millennium Engine: Pure Integer Audit</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background: #050505; color: #00ff41; font-family: 'Courier New', monospace; padding: 20px; }
        .container { max-width: 1200px; margin: auto; border: 1px solid #00ff41; padding: 20px; background: #111; }
        .stats { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-top: 20px; text-align: center; }
        input, button { background: #000; color: #00ff41; border: 1px solid #00ff41; padding: 10px; font-family: inherit; }
        button { background: #00ff41; color: #000; font-weight: bold; cursor: pointer; }
        .highlight { color: #fff; text-shadow: 0 0 5px #00ff41; }
    </style>
</head>
<body>

<div class="container">
    <h2 style="text-align: center;">LEAK-PROOF PRIME AUDIT</h2>
    <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 20px;">
        <input type="number" id="targetR" value="10000" style="width: 150px;">
        <button onclick="runAudit()">RUN BIGINT AUDIT</button>
        <button onclick="exportCSV()" style="background: #ff0055; color: white;">EXPORT CSV</button>
    </div>

    <canvas id="chart" height="400"></canvas>

    <div class="stats">
        <div>Radius: <span id="statR" class="highlight">-</span></div>
        <div>Error: <span id="statErr" class="highlight">-</span></div>
        <div>Alpha (&alpha;): <span id="statAlpha" class="highlight">-</span></div>
    </div>
</div>

<script>
let results = [];
let chart;

async function runAudit() {
    const endR = parseInt(document.getElementById('targetR').value);
    const zeta2 = Math.PI * Math.PI / 6;
    results = [];

    // 1. FAST SIEVE
    const mu = new Int8Array(endR + 1);
    const isPrime = new Uint8Array(endR + 1).fill(1);
    const primes = [];
    mu[1] = 1; 

    for (let i = 2; i <= endR; i++) {
        if (isPrime[i]) { primes.push(i); mu[i] = -1; }
        for (let p of primes) {
            if (i * p > endR) break;
            isPrime[i * p] = 0;
            if (i % p === 0) { mu[i * p] = 0; break; }
            else { mu[i * p] = -mu[i]; }
        }
    }

    // 2. BIGINT SUMMATION (LEAK-PROOF)
    for (let R = 1; R <= endR; R++) {
        let actual = 0n;
        let BigR = BigInt(R);

        for (let d = 1; d <= R; d++) {
            if (mu[d] === 0) continue;
            let floorDiv = BigR / BigInt(d);
            let term = floorDiv * floorDiv; // Square for 2D
            if (mu[d] === 1) actual += term; else actual -= term;
        }

        let expected = (R * R) / zeta2;
        let error = Number(actual) - expected;
        let alpha = R > 1 ? Math.log(Math.abs(error) + 1) / Math.log(R) : 0;
        
        // Goldbach check
        let pairs = 0;
        if (R % 2 === 0 && R > 2) {
            for (let p of primes) {
                if (p > R/2) break;
                if (isPrime[R-p]) pairs++;
            }
        }

        results.push({ R, error, alpha, pairs });

        if (R % 500 === 0) {
            document.getElementById('statR').innerText = R;
            document.getElementById('statAlpha').innerText = alpha.toFixed(4);
            await new Promise(r => setTimeout(r, 1));
        }
    }
    updateUI();
}

function updateUI() {
    const ctx = document.getElementById('chart').getContext('2d');
    if (chart) chart.destroy();
    chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: results.map(d => d.R),
            datasets: [{
                label: 'Normalized Error (Error / R^0.5)',
                borderColor: '#00ff41',
                data: results.map(d => d.error / Math.sqrt(d.R)),
                pointRadius: 0
            }]
        },
        options: { scales: { y: { grid: { color: '#222' } } } }
    });
}

function exportCSV() {
    let csv = "Radius,Error,Alpha,GoldbachPairs\n";
    results.forEach(r => csv += `${r.R},${r.error},${r.alpha},${r.pairs}\n`);
    const blob = new Blob([csv], { type: 'text/csv' });
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'Millennium_Audit.csv';
    a.click();
}
</script>
</body>
</html>

